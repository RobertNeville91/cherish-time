<!--index.wxml-->
<wxs module="m1">
var formatDataToString = function(val) {
  var reg = getRegExp('(.{4})(.{2})(.{2})');
  return val.toString().replace(reg, '$1-$2-$3');
}

module.exports.formatDataToString = formatDataToString;
</wxs>

<view class="authorization" wx:if="{{hasUserInfo === false }}">
  <view class="authorization__box">
    <view class="authorization__ques">惜时光申请获得你的信息</view>
    <view class="authorization__tip">公开信息包含昵称、头像等</view>
    <button loading="{{powerLoading}}" class="authorization__btn" bindgetuserinfo="onGotUserInfo" lang="zh_CN" open-type="getUserInfo">
      允许
    </button>
    <view loading="{{powerLoading}}" class="authorization__btn-no">不允许</view>
  </view>
</view>

<view class="section">
  <scroll-view scroll-y bindscrolltoupper="upper" bindscrolltolower="lower" bindscroll="scroll" scroll-into-view="{{toView}}" scroll-top="{{scrollTop}}">
    <view wx:for="{{ timeList }}">
      <view class="block" style="background : {{item.color}}" bindtap="showMask">
        <view class='blockLeft'>
          <view class="blockTitle">{{item.name}}</view>
          <view class="blockTime">{{ item.type == 1? '目标日':'起始日' }}：{{m1.formatDataToString(item.date)}}</view>
        </view>

        <view class='blockRight'>
          <view id="hadPassLabel">{{ item.type == 1? '剩余':'已过' }}</view>
          <view class='daysDiv'>
            <view id="days">{{item.days}}</view>
            <view id="dayLabel" class="blockDayLable">天</view>
          </view>
          <view class="blockButton">查看详情</view>
        </view>
      </view>
    </view>
  </scroll-view>
</view>

<view class="float-button">
  <picker bindchange="bindPickerChange" value="{{index}}" range="{{array}}">
    <image class="float-button-icon" src="/images/icon-add.png"></image>
  </picker>
</view>

<wxc-mask status="{{maskStatus}}" background-color="#03a9f4" opacity="1">
</wxc-mask>