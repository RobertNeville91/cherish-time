<!--index.wxml-->
<wxs module="m1">
  var formatDataToString = function(val) {
    var reg = getRegExp('(.{4})(.{2})(.{2})');
    return val.toString().replace(reg, '$1-$2-$3');
  }

  module.exports.formatDataToString = formatDataToString;
</wxs>

<view class="authorization" wx:if="{{hasUserInfo === false }}">
  <view class="authorization__box">
    <view class="authorization__ques">惜时光申请获得你的信息</view>
    <view class="authorization__tip">公开信息包含昵称、头像等</view>
    <button loading="{{powerLoading}}" class="authorization__btn" bindgetuserinfo="onGotUserInfo" lang="zh_CN" open-type="getUserInfo">
      允许
    </button>
    <view loading="{{powerLoading}}" class="authorization__btn-no">不允许</view>
  </view>
</view>

<view class="section">
  <scroll-view scroll-y bindscrolltoupper="upper" bindscrolltolower="lower" bindscroll="scroll" scroll-into-view="{{toView}}" scroll-top="{{scrollTop}}">
    <slide-delete wx:for="{{ timeList }}" del-class="list-del" like="true" like-class="list-like" binddelete="_del" bindlike="_like" data-id="{{item.id}}">
      <view class="block" data-item="{{item}}" style="background : {{item.color}}" bindtap="showMask">
        <view class='blockLeft'>
          <view class="blockTitle">{{item.name}}</view>
          <view class="blockTime">{{ item.type == 1? '目标日':'起始日' }}：{{m1.formatDataToString(item.date)}}</view>
        </view>

        <view class='blockRight'>
          <view id="hadPassLabel">{{ item.type == 1? '剩余':'已过' }}</view>
          <view class='daysDiv'>
            <view id="days">{{item.days}}</view>
            <view id="dayLabel" class="blockDayLable">天</view>
          </view>
          <view class="blockButton">查看详情</view>
        </view>
      </view>
    </slide-delete>
  </scroll-view>
  <wxc-loadmore is-end="{{isEnd}}"></wxc-loadmore>
</view>

<view class="float-button">
  <picker bindchange="bindPickerChange" value="{{index}}" range="{{array}}">
    <image class="float-button-icon" src="/images/icon-add.png"></image>
  </picker>
</view>

<view id="fullScreen" class="viewHide{{isShowMask?'ViewShow':''}}">
  <view class="content" style="background-color:{{currentMaskColor}}">
    <view class='full-icon-close' bindtap="hideMask" value='false'>X</view>

    <view id="timeType">{{ currentMaskItem.type==1? '倒数日':'累计日' }}</view>
    <view id="timeName">{{ currentMaskItem.name }}</view>

    <view id="timeName">{{ currentMaskItem.days }}</view>

    <view id="timeName">{{ currentMaskItem.type == 1? '目标日':'起始日' }}：{{m1.formatDataToString(currentMaskItem.date)}}</view>

    <view id="timeName">{{ currentMaskItem.remark }}</view>
  </view>
  <!-- 这里开始才是真正的内容 -->
  {{currentMaskItem.type}}
  <view class="dialog"></view>
</view>